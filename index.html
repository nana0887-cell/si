<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sic Bo - Big/Small</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Google Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Noto+Sans+TC:wght@400;700;900&display=swap"
        rel="stylesheet">

    <style>
        body {
            font-family: 'Inter', 'Noto Sans TC', sans-serif;
            background-color: #0f3d24;
        }

        /* Custom Animations */
        @keyframes shake {
            0% {
                transform: translate(1px, 1px) rotate(0deg);
            }

            10% {
                transform: translate(-1px, -2px) rotate(-1deg);
            }

            20% {
                transform: translate(-3px, 0px) rotate(1deg);
            }

            30% {
                transform: translate(3px, 2px) rotate(0deg);
            }

            40% {
                transform: translate(1px, -1px) rotate(1deg);
            }

            50% {
                transform: translate(-1px, 2px) rotate(-1deg);
            }

            60% {
                transform: translate(-3px, 1px) rotate(0deg);
            }

            70% {
                transform: translate(3px, 1px) rotate(-1deg);
            }

            80% {
                transform: translate(-1px, -1px) rotate(1deg);
            }

            90% {
                transform: translate(1px, 2px) rotate(0deg);
            }

            100% {
                transform: translate(1px, -2px) rotate(-1deg);
            }
        }

        .animate-shake {
            animation: shake 0.5s;
            animation-iteration-count: infinite;
        }

        @keyframes popIn {
            0% {
                transform: scale(0);
                opacity: 0;
            }

            80% {
                transform: scale(1.1);
                opacity: 1;
            }

            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        .animate-pop-in {
            animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        }

        @keyframes floatUp {
            0% {
                transform: translateY(0);
                opacity: 1;
            }

            100% {
                transform: translateY(-50px);
                opacity: 0;
            }
        }

        .animate-float-up {
            animation: floatUp 2s ease-out forwards;
        }

        /* Dice Styles */
        .dice-face {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
            width: 100%;
            height: 100%;
            padding: 6px;
            background: white;
            border-radius: 12px;
            box-shadow: inset 0 0 8px rgba(0, 0, 0, 0.2);
        }

        .dot {
            background-color: #333;
            border-radius: 50%;
            align-self: center;
            justify-self: center;
            width: 10px;
            height: 10px;
        }

        .dot-red {
            background-color: #d93025;
        }

        /* Dice Dot Positioning */
        .d-1 .dot:nth-child(1) {
            grid-area: 2 / 2;
        }

        .d-2 .dot:nth-child(1) {
            grid-area: 1 / 3;
        }

        .d-2 .dot:nth-child(2) {
            grid-area: 3 / 1;
        }

        .d-3 .dot:nth-child(1) {
            grid-area: 1 / 3;
        }

        .d-3 .dot:nth-child(2) {
            grid-area: 2 / 2;
        }

        .d-3 .dot:nth-child(3) {
            grid-area: 3 / 1;
        }

        .d-4 .dot:nth-child(1) {
            grid-area: 1 / 1;
        }

        .d-4 .dot:nth-child(2) {
            grid-area: 1 / 3;
        }

        .d-4 .dot:nth-child(3) {
            grid-area: 3 / 1;
        }

        .d-4 .dot:nth-child(4) {
            grid-area: 3 / 3;
        }

        .d-5 .dot:nth-child(1) {
            grid-area: 1 / 1;
        }

        .d-5 .dot:nth-child(2) {
            grid-area: 1 / 3;
        }

        .d-5 .dot:nth-child(3) {
            grid-area: 2 / 2;
        }

        .d-5 .dot:nth-child(4) {
            grid-area: 3 / 1;
        }

        .d-5 .dot:nth-child(5) {
            grid-area: 3 / 3;
        }

        .d-6 .dot:nth-child(1) {
            grid-area: 1 / 1;
        }

        .d-6 .dot:nth-child(2) {
            grid-area: 1 / 3;
        }

        .d-6 .dot:nth-child(3) {
            grid-area: 2 / 1;
        }

        .d-6 .dot:nth-child(4) {
            grid-area: 2 / 3;
        }

        .d-6 .dot:nth-child(5) {
            grid-area: 3 / 1;
        }

        .d-6 .dot:nth-child(6) {
            grid-area: 3 / 3;
        }

        /* Felt Texture */
        .felt-bg {
            background-color: #0f3d24;
            background-image: radial-gradient(circle at center, #1a5c38 0%, #0f3d24 100%);
        }

        /* 3D Bowl Styles */
        .bowl-container-3d {
            position: relative;
            width: 280px;
            height: 280px;
            perspective: 1000px;
        }

        /* Wrapper for Shaking Base + Cover together */
        .bowl-shaker {
            position: relative;
            width: 100%;
            height: 100%;
            transform-style: preserve-3d;
        }

        .bowl-base {
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 260px;
            height: 130px;
            /* Half height for perspective base */
            background: radial-gradient(circle at 50% 50%, #2d3748, #1a202c);
            border-radius: 0 0 130px 130px;
            /* Bottom hemisphere */
            box-shadow:
                0 10px 20px rgba(0, 0, 0, 0.6),
                inset 0 5px 15px rgba(255, 255, 255, 0.1);
            border: 4px solid #4a5568;
            border-top: none;
            display: flex;
            align-items: flex-start;
            /* Align dice to top of base */
            justify-content: center;
            z-index: 10;
            padding-top: 20px;
        }

        .bowl-cover {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 260px;
            height: 130px;
            /* Half height for top dome */
            background: radial-gradient(circle at 30% 30%, #4a5568, #1a202c);
            border-radius: 130px 130px 0 0;
            /* Top hemisphere (Dome) */
            box-shadow:
                0 5px 15px rgba(0, 0, 0, 0.5),
                inset 2px 2px 20px rgba(255, 255, 255, 0.3),
                inset -5px -5px 20px rgba(0, 0, 0, 0.5);
            border: 2px solid #718096;
            border-bottom: 4px solid #2d3748;
            /* Seam */
            z-index: 20;
            transition: transform 0.8s cubic-bezier(0.34, 1.56, 0.64, 1), opacity 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            transform-origin: bottom center;
        }

        .bowl-cover::after {
            content: '';
            position: absolute;
            top: -15px;
            /* Handle on top */
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 40px;
            border-radius: 10px 10px 0 0;
            background: linear-gradient(to bottom, #fbbf24, #b45309);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.5);
            border: 2px solid #fcd34d;
        }

        .cover-lifted {
            transform: translateX(-50%) translateY(-180px) rotateX(10deg);
            opacity: 0.9;
        }

        /* Dice positioning on base */
        .dice-group {
            display: flex;
            gap: 12px;
            z-index: 15;
            margin-top: -40px;
            /* Pull dice up to sit on the "floor" of the base */
        }
    </style>
</head>

<body class="felt-bg text-white min-h-screen flex items-center justify-center overflow-hidden">
    <div id="root" class="w-full max-w-5xl h-screen max-h-[900px] flex flex-col"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- Constants ---
        const PHASES = {
            SHUFFLING: 'SHUFFLING',
            BETTING: 'BETTING',
            REVEAL: 'REVEAL',
            RESET: 'RESET'
        };

        const CHIPS = [2, 5, 20, 50, 100];
        const BET_TIME = 15;
        const RESET_TIME = 5;

        // --- Components ---

        // 1. Dice Component
        const Dice = ({ value }) => {
            const dots = [];
            const isRed = value === 1 || value === 4;
            const dotClass = isRed ? "dot dot-red" : "dot";

            for (let i = 0; i < value; i++) {
                dots.push(<div key={i} className={dotClass}></div>);
            }

            return (
                <div className={`dice-face d-${value} w-12 h-12 md:w-14 md:h-14 bg-white rounded-xl shadow-lg transform transition-transform hover:scale-105`}>
                    {dots}
                </div>
            );
        };

        // 2. Toast Component
        const Toast = ({ message, type }) => {
            if (!message) return null;
            const bgColor = type === 'error' ? 'bg-red-600' : (type === 'info' ? 'bg-blue-600' : 'bg-yellow-500');
            const textColor = 'text-white';

            return (
                <div className={`fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-[100] px-8 py-4 rounded-lg shadow-2xl ${bgColor} ${textColor} text-xl font-bold animate-bounce border-2 border-white text-center whitespace-nowrap`}>
                    {message}
                </div>
            );
        };

        // 3. Floating Text Component (Win/Loss)
        const FloatingText = ({ text, type }) => {
            if (!text) return null;
            const colorClass = type === 'win' ? 'text-yellow-400' : 'text-red-500';
            return (
                <div className={`absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-full z-[60] text-5xl md:text-7xl font-black ${colorClass} drop-shadow-[0_5px_5px_rgba(0,0,0,0.8)] animate-float-up pointer-events-none whitespace-nowrap`}>
                    {text}
                </div>
            );
        };

        // 4. History Modal Component
        const HistoryModal = ({ isOpen, onClose, history }) => {
            if (!isOpen) return null;

            return (
                <div className="fixed inset-0 z-[200] flex items-center justify-center bg-black/70 backdrop-blur-sm p-4 animate-pop-in">
                    <div className="bg-gray-900 border-2 border-yellow-500 rounded-2xl w-full max-w-2xl max-h-[80vh] flex flex-col shadow-2xl overflow-hidden">
                        {/* Modal Header */}
                        <div className="flex justify-between items-center p-4 border-b border-gray-700 bg-gray-800">
                            <h2 className="text-2xl font-bold text-yellow-400">歷史紀錄 (History)</h2>
                            <button
                                onClick={onClose}
                                className="text-gray-400 hover:text-white transition-colors text-2xl font-bold px-2"
                            >
                                ✕
                            </button>
                        </div>

                        {/* Modal Body - Scrollable Table */}
                        <div className="flex-1 overflow-y-auto p-4">
                            {history.length === 0 ? (
                                <div className="text-center text-gray-500 py-8">暫無紀錄 (No History Yet)</div>
                            ) : (
                                <table className="w-full text-left border-collapse">
                                    <thead>
                                        <tr className="text-gray-400 border-b border-gray-700">
                                            <th className="p-2">Time</th>
                                            <th className="p-2">Round</th>
                                            <th className="p-2">Result</th>
                                            <th className="p-2 text-right">Balance</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {history.slice().reverse().map((entry, idx) => (
                                            <tr key={idx} className="border-b border-gray-800 hover:bg-white/5 transition-colors">
                                                <td className="p-3 text-gray-300 font-mono text-sm">{entry.time}</td>
                                                <td className="p-3 text-yellow-500 font-bold">#{entry.round}</td>
                                                <td className="p-3">
                                                    <span className={`font-bold ${entry.netChange >= 0 ? 'text-green-400' : 'text-red-400'}`}>
                                                        {entry.resultText} ({entry.netChange >= 0 ? '+' : ''}{entry.netChange})
                                                    </span>
                                                </td>
                                                <td className="p-3 text-right font-mono text-white">${entry.balance.toLocaleString()}</td>
                                            </tr>
                                        ))}
                                    </tbody>
                                </table>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        // 5. Main App Component
        const App = () => {
            // State
            const [gameState, setGameState] = useState(PHASES.SHUFFLING);
            const [dice, setDice] = useState([1, 1, 1]);
            const [balance, setBalance] = useState(1000);
            const [currentBets, setCurrentBets] = useState({ big: 0, small: 0 });
            const [selectedChip, setSelectedChip] = useState(5);
            const [timer, setTimer] = useState(BET_TIME);
            const [toast, setToast] = useState({ msg: '', type: '' });
            const [resultData, setResultData] = useState(null); // { text: "BIG", winAmount: 200 }

            // New State for History & Round
            const [round, setRound] = useState(1);
            const [history, setHistory] = useState([]);
            const [showHistory, setShowHistory] = useState(false);

            // Refs
            const timerRef = useRef(null);

            // --- Game Loop Logic ---

            // Phase 1: Shuffling
            useEffect(() => {
                if (gameState === PHASES.SHUFFLING) {
                    // Generate dice immediately but keep hidden
                    const d1 = Math.floor(Math.random() * 6) + 1;
                    const d2 = Math.floor(Math.random() * 6) + 1;
                    const d3 = Math.floor(Math.random() * 6) + 1;
                    setDice([d1, d2, d3]);
                    setResultData(null);

                    // Wait 2 seconds then go to Betting
                    const timeout = setTimeout(() => {
                        setGameState(PHASES.BETTING);
                        setTimer(BET_TIME);
                    }, 2000);
                    return () => clearTimeout(timeout);
                }
            }, [gameState]);

            // Phase 2: Betting Timer
            useEffect(() => {
                if (gameState === PHASES.BETTING) {
                    if (timer > 0) {
                        timerRef.current = setTimeout(() => setTimer(t => t - 1), 1000);
                    } else {
                        setGameState(PHASES.REVEAL);
                    }
                    return () => clearTimeout(timerRef.current);
                }
            }, [gameState, timer]);

            // Phase 3: Reveal & Settlement
            useEffect(() => {
                if (gameState === PHASES.REVEAL) {
                    // Calculate Winnings
                    const sum = dice[0] + dice[1] + dice[2];
                    const isLeopard = dice[0] === dice[1] && dice[1] === dice[2];

                    let totalBet = currentBets.big + currentBets.small;
                    let payout = 0;
                    let resultText = "";
                    let resultType = ""; // 'big', 'small', 'leopard'

                    if (isLeopard) {
                        resultText = "豹子";
                        resultType = 'leopard';
                        // House wins all Big/Small bets
                    } else {
                        const isSmall = sum >= 4 && sum <= 10;
                        const isBig = sum >= 11 && sum <= 17;

                        if (isSmall) {
                            resultText = "小";
                            resultType = 'small';
                            if (currentBets.small > 0) payout += currentBets.small * 2;
                        } else {
                            resultText = "大";
                            resultType = 'big';
                            if (currentBets.big > 0) payout += currentBets.big * 2;
                        }
                    }

                    const netChange = payout - totalBet;

                    // Calculate final balance for history (using the balance from closure, which is post-bet)
                    const finalBalance = balance + payout;

                    // Update Balance State ONLY if there is a payout
                    if (payout > 0) {
                        setBalance(prev => prev + payout);
                    }

                    // Log History
                    const now = new Date();
                    const timeString = now.toTimeString().split(' ')[0];
                    const newHistoryEntry = {
                        time: timeString,
                        round: round,
                        resultText: resultText,
                        netChange: netChange,
                        balance: finalBalance
                    };

                    setHistory(prev => [...prev, newHistoryEntry]);

                    // Delay result data slightly to sync with animation lift
                    setTimeout(() => {
                        setResultData({
                            text: resultText === "豹子" ? "豹子 (LEOPARD)" : (resultText === "小" ? "小 (SMALL)" : "大 (BIG)"),
                            sum: sum,
                            type: resultType,
                            netChange: netChange,
                            payout: payout
                        });
                    }, 500);

                    // Wait 5 seconds then Reset
                    const timeout = setTimeout(() => {
                        setGameState(PHASES.RESET);
                    }, 5000);

                    return () => clearTimeout(timeout);
                }
                // eslint-disable-next-line react-hooks/exhaustive-deps
            }, [gameState, dice, currentBets, round]); // REMOVED 'balance' to prevent infinite loop

            // Phase 4: Reset
            useEffect(() => {
                if (gameState === PHASES.RESET) {
                    setCurrentBets({ big: 0, small: 0 });
                    setToast({ msg: '', type: '' });
                    setRound(r => r + 1); // Increment Round
                    setGameState(PHASES.SHUFFLING);
                }
            }, [gameState]);


            // --- Handlers ---

            const showToast = (msg, type = 'error') => {
                setToast({ msg, type });
                if (type === 'error' || type === 'info') {
                    setTimeout(() => setToast({ msg: '', type: '' }), 2000);
                }
            };

            const handleBet = (zone) => {
                if (gameState !== PHASES.BETTING) return;

                // Mutual Exclusivity Check
                if (zone === 'big' && currentBets.small > 0) {
                    showToast("不可同時下注大小 (Cannot bet both)", "error");
                    return;
                }
                if (zone === 'small' && currentBets.big > 0) {
                    showToast("不可同時下注大小 (Cannot bet both)", "error");
                    return;
                }

                // Check Balance
                if (balance < selectedChip) {
                    showToast("餘額不足 (Insufficient Balance)", "error");
                    return;
                }

                // Place Bet
                setBalance(b => b - selectedChip);
                setCurrentBets(prev => ({
                    ...prev,
                    [zone]: prev[zone] + selectedChip
                }));
            };

            const handleConfirm = () => {
                if (gameState === PHASES.BETTING) {
                    setTimer(0); // Immediately triggers REVEAL via useEffect
                }
            };

            const handleCancel = () => {
                if (gameState !== PHASES.BETTING) return;

                const totalBet = currentBets.big + currentBets.small;
                if (totalBet === 0) return;

                setBalance(b => b + totalBet);
                setCurrentBets({ big: 0, small: 0 });
                showToast("已取消下注 (Bets Cleared)", "info");
            };

            // --- Render Helpers ---

            const getBowlContent = () => {
                const isShaking = gameState === PHASES.SHUFFLING;
                const isRevealed = gameState === PHASES.REVEAL || gameState === PHASES.RESET;

                // Wrapper class for shaking the WHOLE bowl (Base + Cover)
                const shakerClass = isShaking ? 'animate-shake' : '';

                return (
                    <div className="bowl-container-3d">
                        {/* Shaker Wrapper: Moves Base and Cover together */}
                        <div className={`bowl-shaker ${shakerClass}`}>

                            {/* Base with Dice */}
                            <div className="bowl-base">
                                <div className="dice-group">
                                    {dice.map((d, i) => <Dice key={i} value={d} />)}
                                </div>
                            </div>

                            {/* Cover - Only lifts in REVEAL/RESET phase */}
                            <div className={`bowl-cover ${isRevealed ? 'cover-lifted' : ''}`}>
                                {/* Handle is pseudo-element */}
                            </div>
                        </div>

                        {/* Result Text Overlay (Floating above bowl) */}
                        {isRevealed && resultData && (
                            <div className="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-50 animate-pop-in pointer-events-none">
                                <div className="text-5xl font-black text-white drop-shadow-[0_5px_5px_rgba(0,0,0,0.8)] bg-black/60 px-6 py-3 rounded-2xl backdrop-blur-sm border border-white/20">
                                    {resultData.sum} 點
                                </div>
                            </div>
                        )}
                    </div>
                );
            };

            return (
                <div className="flex flex-col h-full w-full select-none relative overflow-hidden">
                    <Toast message={toast.msg} type={toast.type} />
                    <HistoryModal isOpen={showHistory} onClose={() => setShowHistory(false)} history={history} />

                    {/* Floating Win/Loss Text */}
                    {gameState === PHASES.REVEAL && resultData && resultData.netChange !== 0 && (
                        <FloatingText
                            text={resultData.netChange > 0 ? `+$${resultData.netChange}` : `-$${Math.abs(resultData.netChange)}`}
                            type={resultData.netChange > 0 ? 'win' : 'lose'}
                        />
                    )}

                    {/* Header */}
                    <header className="flex-none flex justify-between items-center p-4 bg-black/40 backdrop-blur-md border-b border-white/10 z-50">
                        <div className="flex flex-col">
                            <h1 className="text-xl md:text-2xl font-bold text-yellow-400 tracking-wider">SIC BO (骰寶)</h1>
                            <span className="text-xs md:text-sm text-gray-400 font-mono">Round #{round} (第 {round} 局)</span>
                        </div>

                        <div className="flex items-center gap-4">
                            <div className="flex flex-col items-end">
                                <span className="text-gray-300 text-xs">餘額 (Balance)</span>
                                <span className="text-xl md:text-2xl font-mono text-yellow-400 font-bold">${balance.toLocaleString()}</span>
                            </div>

                            <button
                                onClick={() => setShowHistory(true)}
                                className="bg-gray-800 hover:bg-gray-700 text-white p-2 rounded-full border border-gray-600 transition-colors"
                                title="History"
                            >
                                {/* Clock Icon SVG */}
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className="w-6 h-6">
                                    <path strokeLinecap="round" strokeLinejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z" />
                                </svg>
                            </button>
                        </div>
                    </header>

                    {/* Game Area */}
                    <main className="flex-1 flex flex-col items-center justify-center relative w-full overflow-y-auto p-2">

                        {/* Status / Result Banner */}
                        <div className="absolute top-2 z-0 text-center w-full flex items-center justify-center pointer-events-none">
                            {gameState === PHASES.REVEAL && resultData ? (
                                <h2 className={`text-5xl md:text-6xl font-black drop-shadow-[0_5px_5px_rgba(0,0,0,0.8)] animate-pop-in
                                    ${resultData.type === 'big' ? 'text-red-500' : ''}
                                    ${resultData.type === 'small' ? 'text-blue-500' : ''}
                                    ${resultData.type === 'leopard' ? 'text-yellow-400' : ''}
                                `}>
                                    {resultData.text}
                                </h2>
                            ) : (
                                <h2 className="text-2xl md:text-3xl font-bold text-white/80 drop-shadow-md">
                                    {gameState === PHASES.SHUFFLING && "洗牌中 (Shuffling)..."}
                                    {gameState === PHASES.BETTING && `下注時間: ${timer}s`}
                                    {gameState === PHASES.RESET && "準備下一局 (Next Round)..."}
                                </h2>
                            )}
                        </div>

                        {/* Bowl */}
                        <div className="mt-8 mb-4 transform scale-90 md:scale-100 transition-transform z-10">
                            {getBowlContent()}
                        </div>

                        {/* Betting Board */}
                        <div className="w-full max-w-4xl grid grid-cols-2 gap-4 md:gap-8 px-2 md:px-4 z-10">
                            {/* SMALL Zone */}
                            <button
                                onClick={() => handleBet('small')}
                                disabled={gameState !== PHASES.BETTING || currentBets.big > 0}
                                className={`
                                    relative h-36 md:h-48 rounded-2xl border-4 flex flex-col items-center justify-center transition-all duration-200 group
                                    ${gameState === PHASES.BETTING ? 'hover:bg-white/5 cursor-pointer active:scale-95' : 'cursor-default opacity-80'}
                                    ${currentBets.big > 0 ? 'opacity-30 grayscale' : ''}
                                    ${gameState === PHASES.REVEAL && resultData?.type === 'small' ? 'bg-blue-500/30 border-blue-400 shadow-[0_0_50px_rgba(59,130,246,0.6)] scale-105 z-20' : 'bg-blue-900/40 border-blue-500/50'}
                                `}
                            >
                                <div className="text-5xl md:text-7xl font-black text-blue-200 mb-2 group-hover:text-blue-100">小</div>
                                <div className="text-xl md:text-3xl text-blue-300 font-bold">SMALL (4-10)</div>
                                {currentBets.small > 0 && (
                                    <div className="absolute top-4 right-4 bg-yellow-500 text-black font-bold rounded-full w-10 h-10 md:w-14 md:h-14 flex items-center justify-center shadow-lg border-2 border-white text-sm md:text-lg">
                                        ${currentBets.small}
                                    </div>
                                )}
                            </button>

                            {/* BIG Zone */}
                            <button
                                onClick={() => handleBet('big')}
                                disabled={gameState !== PHASES.BETTING || currentBets.small > 0}
                                className={`
                                    relative h-36 md:h-48 rounded-2xl border-4 flex flex-col items-center justify-center transition-all duration-200 group
                                    ${gameState === PHASES.BETTING ? 'hover:bg-white/5 cursor-pointer active:scale-95' : 'cursor-default opacity-80'}
                                    ${currentBets.small > 0 ? 'opacity-30 grayscale' : ''}
                                    ${gameState === PHASES.REVEAL && resultData?.type === 'big' ? 'bg-red-500/30 border-red-400 shadow-[0_0_50px_rgba(239,68,68,0.6)] scale-105 z-20' : 'bg-red-900/40 border-red-500/50'}
                                `}
                            >
                                <div className="text-5xl md:text-7xl font-black text-red-200 mb-2 group-hover:text-red-100">大</div>
                                <div className="text-xl md:text-3xl text-red-300 font-bold">BIG (11-17)</div>
                                {currentBets.big > 0 && (
                                    <div className="absolute top-4 right-4 bg-yellow-500 text-black font-bold rounded-full w-10 h-10 md:w-14 md:h-14 flex items-center justify-center shadow-lg border-2 border-white text-sm md:text-lg">
                                        ${currentBets.big}
                                    </div>
                                )}
                            </button>
                        </div>
                    </main>

                    {/* Control Panel */}
                    <footer className="flex-none bg-black/80 p-4 backdrop-blur-xl border-t border-white/10 w-full z-50 shadow-[0_-10px_40px_rgba(0,0,0,0.5)]">
                        <div className="max-w-6xl mx-auto flex flex-col md:flex-row items-center justify-between gap-4">

                            {/* Chips */}
                            <div className="flex items-center justify-center gap-3 md:gap-6">
                                {CHIPS.map(val => (
                                    <button
                                        key={val}
                                        onClick={() => setSelectedChip(val)}
                                        className={`
                                            relative w-12 h-12 md:w-16 md:h-16 rounded-full border-4 flex items-center justify-center font-bold shadow-lg transition-all
                                            ${selectedChip === val ? 'scale-110 -translate-y-2 ring-4 ring-yellow-400 z-10 shadow-yellow-500/50' : 'hover:scale-105 opacity-90 hover:opacity-100'}
                                            ${val === 2 ? 'bg-blue-600 border-blue-300' : ''}
                                            ${val === 5 ? 'bg-red-600 border-red-300' : ''}
                                            ${val === 20 ? 'bg-green-600 border-green-300' : ''}
                                            ${val === 50 ? 'bg-purple-600 border-purple-300' : ''}
                                            ${val === 100 ? 'bg-gray-900 border-yellow-500 text-yellow-500' : ''}
                                        `}
                                    >
                                        <span className="drop-shadow-md text-sm md:text-lg">{val}</span>
                                    </button>
                                ))}
                            </div>

                            {/* Actions */}
                            <div className="flex items-center gap-4 w-full md:w-auto justify-center">
                                <div className="flex flex-col w-full md:w-auto gap-1">
                                    <div className="text-xs text-gray-400 text-center">Time Left</div>
                                    <div className="h-4 bg-gray-700 rounded-full w-24 md:w-40 overflow-hidden border border-gray-600 relative">
                                        <div
                                            className="h-full bg-gradient-to-r from-yellow-600 to-yellow-400 transition-all duration-1000 ease-linear"
                                            style={{ width: `${(timer / BET_TIME) * 100}%` }}
                                        ></div>
                                    </div>
                                </div>

                                <div className="flex gap-2">
                                    <button
                                        onClick={handleCancel}
                                        disabled={gameState !== PHASES.BETTING || (currentBets.big === 0 && currentBets.small === 0)}
                                        className={`
                                            px-4 py-3 rounded-xl font-bold text-base md:text-lg shadow-lg transition-all whitespace-nowrap border-b-4 active:border-b-0 active:translate-y-1
                                            ${gameState === PHASES.BETTING && (currentBets.big > 0 || currentBets.small > 0)
                                                ? 'bg-red-600 hover:bg-red-500 text-white border-red-800'
                                                : 'bg-gray-700 text-gray-500 cursor-not-allowed border-gray-800'}
                                        `}
                                    >
                                        取消 (Clear)
                                    </button>

                                    <button
                                        onClick={handleConfirm}
                                        disabled={gameState !== PHASES.BETTING}
                                        className={`
                                            px-6 py-3 rounded-xl font-bold text-base md:text-lg shadow-lg transition-all whitespace-nowrap border-b-4 active:border-b-0 active:translate-y-1
                                            ${gameState === PHASES.BETTING
                                                ? 'bg-yellow-500 hover:bg-yellow-400 text-black border-yellow-700'
                                                : 'bg-gray-700 text-gray-500 cursor-not-allowed border-gray-800'}
                                        `}
                                    >
                                        確定 (Confirm)
                                    </button>
                                </div>
                            </div>
                        </div>
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>

</html>